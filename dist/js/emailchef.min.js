"use strict";var WC_Emailchef=function(s){var t,l,n,i,a,c,o,r,d="wc_emailchef";return{go:function(){r=s("#"+f("lang")),t=s("#"+f("create_list")),l=s("#"+f("list")),n=s("#"+f("api_user")),i=s("#"+f("api_pass")),s("#"+f("new_name")),s("#"+f("new_description")),s("#"+f("new_save")),a=s("#"+f("policy_type")),c=s("#"+f("landing_page")),o=s("#"+f("fuck_page")),r.on("change",function(e){s.ajax({type:"POST",url:ajaxurl,data:{action:""+f("changelanguage"),data:{lang:r.val()}},dataType:"json",success:function(e){confirm(e.msg)&&location.reload()},error:function(){},complete:function(){}})}),t.on("click",function(e){e.preventDefault(),s(".tr-info-color").length||t.closest("tr").after('<tr class="tr-info-color" valign="top"><th scope="row" class="titledesc"><label for="wc_emailchef_new_name">'+wcec.list_name+'</label></th><td class="forminp forminp-text"><input name="wc_emailchef_new_name" id="wc_emailchef_new_name" type="text" dir="ltr" style="min-width:350px;" value="" class="" placeholder="'+wcec.list_name_placeholder+'">‎</td></tr><tr class="tr-info-color" valign="top"><th scope="row" class="titledesc"><label for="wc_emailchef_new_description">'+wcec.list_description+'</label></th><td class="forminp forminp-text"><input name="wc_emailchef_new_description" id="wc_emailchef_new_description" type="text" dir="ltr" style="min-width:350px;" value="" class="" placeholder="'+wcec.list_description_placeholder+'">‎</td></tr><tr class="tr-info-color" valign="top"><th scope="row" class="titledesc"><label for="wc_emailchef_new_save">'+wcec.create_label+'</label></th><td class="forminp forminp-text"><button name="wc_emailchef_save" class="button-primary woocommerce-save-button" id="wc_emailchef_new_save" >'+wcec.create+'</button>‎&nbsp;&nbsp;<button name="wc_emailchef_undo" class="button woocommerce-undo-button" id="wc_emailchef_undo_save" >'+wcec.undo+'</button>‎</td></tr><tr class="tr-info-color" valign="top"><td colspan="2">'+wcec.info+"</td></tr>")}),s(document).on("click","#"+f("new_save"),function(e){var a,c,t,o;e.preventDefault(),a=n.val(),c=i.val(),t=s("#"+f("new_name")).val(),o=s("#"+f("new_description")).val(),l.attr("disabled","disabled"),s.post(ajaxurl,{action:""+f("add_list"),data:{api_user:a,api_pass:c,list_name:t,list_desc:o}},function(e){console.log(e);var t=s.parseJSON(e);"success"===t.type?(s(".tr-info-color").remove(),u(a,c,t.list_id)):alert(t.msg)})}),s(document).on("click","#"+f("undo_save"),function(e){e.preventDefault(),s(".tr-info-color").remove()}),a.on("change",function(e){e.preventDefault(),"sopt"===s(this).val()?(c.closest("tr").fadeOut(),o.closest("tr").fadeOut()):(c.closest("tr").fadeIn(),o.closest("tr").fadeIn())}),l.closest("tr").hide(),s("#"+f("api_user")+", #"+f("api_pass")).change(function(){e(n.val(),i.val(),!0)}),e(n.val(),i.val(),!1)}};function p(e){var t=i.closest("tr").nextAll("tr");"show"===e?t.fadeIn():t.fadeOut()}function _(e){"show"===e?a.closest("tr").css("display","table-row"):(a.find("option[value='dopt']").attr("selected","selected"),a.closest("tr").fadeOut())}function e(a,c,o){p("hide"),s("button[name='save']").attr("disabled","disabled"),s("#check_login_data").remove(),""!==a&&""!==c&&(s('<span id="check_login_data">'+wcec.check_data+"</span>").insertAfter(n),l.attr("disabled","disabled"),s.post(ajaxurl,{action:""+f("account"),data:{api_user:a,api_pass:c}},function(e){s("button[name='save']").removeAttr("disabled");var t=s.parseJSON(e);"error"!=t.type?(s("#check_login_data").removeClass().addClass("success").html('<i class="dashicons dashicons-yes"></i>'),p("show"),console.log("Policy = "+t.policy),"premium"!==t.policy?(console.log("Policy != premium, remove other policy options"),_("hide")):_("show"),l.removeAttr("disabled"),o&&(console.log("Loading lists..."),u(a,c,-1))):s("#check_login_data").removeClass().addClass("error").html('<i class="dashicons dashicons-warning"></i> '+wcec.error_login)}))}function u(e,t,o){l.attr("disabled","disabled"),s.post(ajaxurl,{action:""+f("lists"),data:{api_user:e,api_pass:t}},function(e){var a,c,t=s.parseJSON(e);"success"===t.type&&(a=!1,c=l.select2("val"),l.select2("destroy"),l.removeAttr("disabled"),l.empty(),s.each(t.lists,function(e,t){e===c&&(a=!0),l.prepend(s("<option></option>").attr("value",e).text(t))}),l.select2(),-1!==o?(console.log("Seleziono lista creata: "+o),l.select2("val",o).trigger("change")):a&&l.select2("val",c).trigger("change"))})}function f(e){return d+"_"+e}}(jQuery);